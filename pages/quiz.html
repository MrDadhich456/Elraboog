<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quiz Panel</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    /* General Styles */
    body {
      margin: 0;
      padding: 0;
      background-color: #0D1117;
      color: white;
      font-family: 'Roboto', sans-serif;
    }

    .container {
      display: flex;
      height: 100vh;
      flex-direction: column;
    }

    .header {
      background-color:#0D1117;
      padding: 10px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid #28353D;
    }

    .header img {
      height: 40px;
    }

    .header .timer {
      font-size: 16px;
      color: #d4d4d4;
    }

    main {
      display: flex;
      flex: 1;
    }

    .quiz-container {
      flex: 3;
      padding: 20px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }

    .question-image {
      width: 100%;
      max-width: 500px;
      height: 200px;
      background-color: #ccc;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 24px;
      color: black;
      margin-bottom: 30px;
      border-radius: 10px;
      overflow-y: auto;
    }

    .options {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      width: 100%;
      max-width: 600px;
      margin-bottom: 20px;
    }

    .answer-option {
      padding: 20px 40px;
      font-size: 16px;
      background-color: #ECF2F8;
      border: none;
      border-radius: 12px;
      color: #000000;
      cursor: pointer;
      text-align: center;
      border: 1px solid #8A9CA7; /* Lighter border on hover/focus */
  box-shadow: 0 0 6px rgba(138, 156, 167, 0.6); /* Glowing effect */
    }

    .answer-option:hover {
      background-color: #444;
    }

    .answer-option.selected {
      background-color: #10b981;
    }

    .navigation-buttons {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
      width: 100%;
      max-width: 600px;
      
    }

    .navigation-buttons button {
      padding: 15px 30px;
      font-size: 16px;
      background-color: #ECF2F8;
      border: none;
      border-radius: 5px;
      color: #000000;
      cursor: pointer;
      border: 1px solid #8A9CA7; /* Lighter border on hover/focus */
  box-shadow: 0 0 6px rgba(138, 156, 167, 0.6); /* Glowing effect */
    }

    .navigation-buttons button:hover {
      background-color: #444;
    }

    .sidebar {
      flex: 1;
      background-color: #28353D;
     
      margin: 20px 5px;
      border-radius: 12px 0px 0px 12px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .text{
      width: 100%;
      border-bottom:2px solid #ECF2F8;
      text-align: center;
  
    }
    .sidebar h3 {
      color: #ffffff;
      font-size: 24px;
    }

    .question-navigation {
      padding: 16px;
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 23px;
    }

    .question-number {
      width: 50px;
      height: 50px;
      background-color: #ECF2F8;
      color: #000000;
      display: flex;
      justify-content: center;
      align-items: center;
      border-radius: 50%;
      cursor: pointer;
    }

    .question-number.selected {
      background-color: #0D1117;
      color:#ffffff;
    }

    .question-number:hover {
      background-color: #555;
    }

    #submit {
      display: block;
    width: 50%;
    margin: 10px auto 15px;
    padding: 15px 30px ;
    font-size: 20px;
    font-weight: bold;
    color: #000000;
    background-color: #ECF2F8;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    transition: background-color 0.3s;
    }

    #submit:hover {
      background-color: #444;
    }

    /* Modal styles */
    #submit-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background:#28353D;
      display: none;
      justify-content: center;
      align-items: center;
    }

    .modal-content {
      background: #0D1117;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      color: white;
    }

    .modal-content button {
      margin-top: 20px;
      background-color: #ECF2F8;
      border: none;
      padding: 10px 20px;
      font-size: 16px;
      color: white;
      cursor: pointer;
    }

    .modal-content button:hover {
      background-color: #444;
    }
  </style>
</head>
<body>
  <div class="container">
    <header class="header">
      <img src="../assest/img/logo/Black_And_White_Illustrated_Eagle_Logo__1___1_-removebg 1.png" alt="Logo">
      <div class="timer" id="timer">TIME: 60:00</div>
    </header>
    <main>
      <div class="quiz-container">
        <div class="question-image" id="question-image">Image</div>
        <div class="options" id="options-container"></div>
        <div class="navigation-buttons">
          <button id="previous">Previous</button>
          <button id="clear-answer">Clear Answer</button>
          <button id="next">Next</button>
        </div>
      </div>
      <aside class="sidebar">
        <div class="text">
        <h3>QUESTIONS</h3></div>
        <div class="question-navigation" id="question-navigation"></div>
        <button id="submit">SUBMIT</button>
      </aside>
    </main>
  </div>

  <!-- Confirmation Modal -->
  <div id="submit-modal">
    <div class="modal-content">
      <h3>Are you sure you want to submit?</h3>
      <p id="attempted-questions"></p>
      <p id="unanswered-questions"></p>
      <p id="total-score"></p>
      <p id="total-time"></p>
      <button id="final-submit">Yes, Submit</button>
      <button id="cancel-submit">Cancel</button>
    </div>
  </div>

  <script>
    const quizzes = [
      {
        chapter: "Sample Chapter",
        questions: [
          {
            questionImage: "https://via.placeholder.com/500x200?text=Question+1",
            options: ["Option A", "Option B", "Option C", "Option D"],
            correctAnswer: 0,
          },
          {
            questionImage: "https://via.placeholder.com/500x200?text=Question+2",
            options: ["Option A", "Option B", "Option C", "Option D"],
            correctAnswer: 1,
          },
          {
            questionImage: "https://via.placeholder.com/500x200?text=Question+3",
            options: ["Option A", "Option B", "Option C", "Option D"],
            correctAnswer: 2,
          },
        ],
      },
    ];

    const selectedChapter = quizzes[0];
    let currentQuestionIndex = 0;
    let answers = Array(selectedChapter.questions.length).fill(null);
    let timerInterval;
    let remainingTime = 60 * 60; // 1 hour

    const questionImage = document.getElementById("question-image");
    const optionsContainer = document.getElementById("options-container");
    const questionNavigation = document.getElementById("question-navigation");
    const timerDisplay = document.getElementById("timer");

    // Timer function
    function startTimer() {
      timerInterval = setInterval(() => {
        if (remainingTime <= 0) {
          clearInterval(timerInterval);
          showSubmitModal();
        } else {
          remainingTime--;
          const minutes = Math.floor(remainingTime / 60);
          const seconds = remainingTime % 60;
          timerDisplay.innerText = `TIME: ${minutes}:${seconds < 10 ? '0' + seconds : seconds}`;
        }
      }, 1000);
    }

    // Load question
    function loadQuestion(index) {
      const question = selectedChapter.questions[index];
      questionImage.innerHTML = `<img src="${question.questionImage}" alt="Question Image" style="max-width: 100%; max-height: 100%;">`;
      optionsContainer.innerHTML = question.options
        .map(
          (option, idx) => `
          <button class="answer-option ${answers[index] === idx ? 'selected' : ''}" data-index="${idx}">
            ${option}
          </button>`
        )
        .join("");

      // Update question navigation
      questionNavigation.innerHTML = selectedChapter.questions
        .map(
          (question, idx) => `
          <div class="question-number ${answers[idx] !== null ? 'selected' : ''}" data-index="${idx}">
            ${idx + 1}
          </div>`
        )
        .join("");

      // Add event listeners for options
      const answerOptions = optionsContainer.querySelectorAll(".answer-option");
      answerOptions.forEach((option) => {
        option.addEventListener("click", () => {
          answers[index] = parseInt(option.dataset.index);
          loadQuestion(index);
        });
      });
    }

    // Handle question navigation
    questionNavigation.addEventListener("click", (event) => {
      if (event.target.classList.contains("question-number")) {
        currentQuestionIndex = parseInt(event.target.dataset.index);
        loadQuestion(currentQuestionIndex);
      }
    });

    // Handle clear answer
    document.getElementById("clear-answer").addEventListener("click", () => {
      answers[currentQuestionIndex] = null;
      loadQuestion(currentQuestionIndex);
    });

    // Handle previous/next question
    document.getElementById("previous").addEventListener("click", () => {
      if (currentQuestionIndex > 0) {
        currentQuestionIndex--;
        loadQuestion(currentQuestionIndex);
      }
    });

    document.getElementById("next").addEventListener("click", () => {
      if (currentQuestionIndex < selectedChapter.questions.length - 1) {
        currentQuestionIndex++;
        loadQuestion(currentQuestionIndex);
      }
    });

    // Handle submit
    document.getElementById("submit").addEventListener("click", showSubmitModal);

    function showSubmitModal() {
      const attemptedQuestions = answers.filter((answer) => answer !== null).length;
      const unansweredQuestions = answers.filter((answer) => answer === null).length;
      const score = calculateScore();
      const timeTaken = formatTime(60 * 60 - remainingTime);

      document.getElementById("attempted-questions").innerText = `Attempted: ${attemptedQuestions}`;
      document.getElementById("unanswered-questions").innerText = `Unanswered: ${unansweredQuestions}`;
      document.getElementById("total-score").innerText = `Score: ${score}/${selectedChapter.questions.length}`;
      document.getElementById("total-time").innerText = `Time Taken: ${timeTaken}`;
      document.getElementById("submit-modal").style.display = "flex";
    }

    function handleFinalSubmit() {
      // Stop the timer when final submit is clicked
      clearInterval(timerInterval);
    
      // Calculate the score
      let score = 0;
      selectedChapter.questions.forEach((question, index) => {
        if (answers[index] !== null && answers[index] === question.correctAnswer) {
          score++;
        }
      });
    
      // Store the score, attempted, unanswered, and time in localStorage
      localStorage.setItem("attempted", answers.filter((answer) => answer !== null).length);
      localStorage.setItem("unanswered", answers.filter((answer) => answer === null).length);
    
      // Format the time in min:sec and save it
      const timeTakenFormatted = formatTime(60 * 60 - remainingTime); // Time used during quiz
      localStorage.setItem("timeTaken", timeTakenFormatted);
      localStorage.setItem("score", score); // Store score
    
      // Redirect to the result page after submission
      window.location.href = "result.html"; // Redirect to result page
    }
    
    // Start the quiz
    loadQuestion(currentQuestionIndex);
    startTimer();
  </script>
</body>
</html>
